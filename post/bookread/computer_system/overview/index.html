<!DOCTYPE html>
<html>

    <head>
        <title> &lt;&lt;深入了解计算机系统&gt;&gt;整理 &middot; trainyao.github.io </title>

        <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.59.1" />


<script   src="https://code.jquery.com/jquery-3.1.1.min.js"   integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="   crossorigin="anonymous"></script>


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>


<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">


<link rel="stylesheet" href="https://trainyao.github.io/css/nix.css">


<link href="https://fonts.googleapis.com/css?family=Inconsolata%7COpen+Sans%7CConcert+One" rel="stylesheet">




    </head>

    <body>
        <header>
<nav class="navbar navbar-default navbar-fixed-top navbar-inverse font-header">
	<div class="container-fluid">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse-1" aria-expanded="false">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" id="green-terminal" href=https://trainyao.github.io/>trainyao@home ~ $</a>
		</div>

		
		<div class="collapse navbar-collapse" id="navbar-collapse-1">
			<ul class="nav navbar-nav navbar-right">
				<li>
					<a href="https://trainyao.github.io/">/home/trainyao</a>
				</li>
				
				
				<li class="dropdown">
                    
            		<a href="/post/">~/all</a>
            		
        		</li>
        		
				
				<li class="dropdown">
                    
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">category <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        
                    		<li>
                    		<a href="/categories/kubernetes/">~/kubernetes</a>
				    		</li>
                		
                    		<li>
                    		<a href="/categories/istio/">~/service mesh/istio</a>
				    		</li>
                		
                    		<li>
                    		<a href="/categories/gloo/">~/service mesh/envoy/gloo</a>
				    		</li>
                		
                    		<li>
                    		<a href="/categories/mosn/">~/service mesh/mosn</a>
				    		</li>
                		
                    		<li>
                    		<a href="/categories/skynet/">~/skynet</a>
				    		</li>
                		
                    		<li>
                    		<a href="/categories/%E8%84%91%E6%B4%9E/">~/脑洞</a>
				    		</li>
                		
                    		<li>
                    		<a href="/categories/%E5%85%B6%E4%BB%96/">~/其他</a>
				    		</li>
                		
                    		<li>
                    		<a href="/categories/%E7%BF%BB%E8%AF%91/">~/翻译</a>
				    		</li>
                		
                    		<li>
                    		<a href="/categories/kubernetes-%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97/">~/读书笔记/kubernetes 权威指南</a>
				    		</li>
                		
                    		<li>
                    		<a href="/categories/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/">~/读书笔记/深入理解计算机系统</a>
				    		</li>
                		
            		</ul>
            		
        		</li>
        		

			</ul>
		</div>
	</div>
</nav>
</header>

        <div class="container wrapper">
            <h1><a href="https://trainyao.github.io/post/bookread/computer_system/overview/">&lt;&lt;深入了解计算机系统&gt;&gt;整理</a></h1>
            <span class="post-date">Feb 9, 2018 </span>
            <div class="post-content">
                

<h2 id="一-信息在计算机里面的存储">一. 信息在计算机里面的存储</h2>

<p>无论是保存在硬盘里面作永久储存,还是保存在内存/寄存器里面作为计算的临时储存,信息在计算机里面需要一个表示方法,或者叫做保存方法.</p>

<p>首先,可以先来看一下c语言都有哪些信息的类型,或者说我们编程时候都用到哪些信息类型:</p>

<ul>
<li>布尔型,表示是与否</li>
<li>整型,表示整数</li>
<li>浮点型,表示小数</li>
<li>字符串,表示一系列字符的集合</li>
<li>数组,一系列上述类型的集合</li>
<li>对象,一系列上述类型的索引集合</li>
</ul>

<p>其中,布尔型可以用简单的 整型0&amp;整型1 表示,就不单独说明.</p>

<p>由于一些基本的概念,比如字符串用ASCII码/UTF-8编码表示,整型根据不同的长度有,是否有符号,会有不同的范围,下面只挑选不同信息类型(或者叫数据类型)的值得提一下的点作说明.</p>

<ul>
<li>整型:</li>
</ul>

<p>整型无符号形式不用多说,而有符号的表示形式除了简单的使用最高位作为符号位(1000 0001 表示-1),还有两种表现形式:<strong>补码表示</strong>和<strong>反码表示</strong>.</p>

<p>实际上,补码相对于原码和反码,对于计算机的计算是更优化的.大多数现代计算机都用补码表示有符号数.</p>

<p>补码中, 如 1000 0001,将最高有效位解释成<strong>负权</strong>,而后, 所以 1000 1111 =  <strong>-</strong>2^7 <strong>+</strong>2^3 <strong>+</strong>2^2 <strong>+</strong>2^1 <strong>+</strong>2^0 = -113</p>

<p>而反码就与补码类似,不过补码的负权为 - 2 ^(w-1),  反码的负权为 -2^(w-1) - 1, 其中w为整型长度</p>

<p>补码相比反码和原码(即最高位表示符号位的形式)的差别在于:</p>

<ol>
<li><p>补码的0000 0000表示0,没有-0表示,而反码和原码都存在一个-0表示 (反码为1111 1111, 原码为 1000 0000)</p></li>

<li><p>补码的加减乘除运算,都等价于将补码转换为无符号数的加减乘除,再转换回补码,而反码和原码都要先作相应的转换.(至于为什么反码和补码不能直接运算,可以参考<a href="https://www.cnblogs.com/zhangziqiu/archive/2011/03/30/ComputerCode.html">这个文章: 原码, 反码, 补码 详解</a>)</p></li>
</ol>

<ul>
<li>浮点型</li>
</ul>

<p>书中介绍了一种浮点型表示的标准: IEEE浮点表示.</p>

<p>IEEE浮点表示用是三部分来表示一个浮点数: 符号位,尾数,阶码</p>

<p>其中,符号位s直接编码正负; 尾数和阶码编码浮点数的两部分值得: 指数E和小数M&hellip;浮点数V可以表示为: V = (-1)^s * M * 2^E</p>

<p>指数M和尾数E的计算如图&hellip;</p>

<h2 id="2-使用存储的信息进行运算">2. 使用存储的信息进行运算</h2>

<p>在计算机中,常用的运算有加,减,乘,除,取模,取反,位移.</p>

<p>其中加,减,取反,位移,都可以直接在信息的位表示直接操作,而乘,除,取模比较特殊.</p>

<ul>
<li>乘法</li>
</ul>

<p>可以回想一下笔算乘法的过程,需要将乘数的各个位与被乘数相乘,再作相加.其中还涉及进位操作.如果计算机计算单元使用乘法的定义来进行乘法运算,可以想象需要很多步骤,而乘法作为基础的运算,太过复杂的运算显然是不能接受的.</p>

<p>于是人们利用了在计算机中,加法和位移是计算速度较快的特性(一次计算只需一个时钟周期),将乘法优化为被乘数乘以2的n次幂,再加上一个数,如:</p>

<pre><code class="language-c">7 * 25
= (7 * 16) + (7 * 8) + (7 * 1)
= (7 * 2^4) + (7 * 2^3) + 7
</code></pre>

<p>如此, 7 * 25 被优化至5个时钟周期(位移*2 + 加法*3)即可完成</p>

<h4 id="3-机器机语言">3. 机器机语言</h4>

<p>为什么需要计算机语言?</p>

<p>逻辑计算,其实可以看作是对于计算机里面数据的访问(读)和修改(写).计算机语言可以看做是读写这些数据的命令.汇编语言就是这种命令.而像C,php这类高级语言..只是汇编的一些封装.当高级语言需要执行时,并通过编译/虚拟机的形式..还原回汇编语言去对数据进行操作.</p>

<p>看计算机语言如何在计算机里执行,可以分拆开一个一个汇编命令的执行过程</p>

<ul>
<li>命令
从读写两个方面去将汇编命令分类,有:</li>
<li>读: 访存/访寄存器mov lea:读取内存/寄存器地址</li>
<li>写: 自增inc/减dec; 取负neg/补not; 加add减sub有符号乘imul无符号乘mul; 有符号除idiv无符号除div 异或xor或or与and; 左移shl/sal; 逻辑右移shr 算数右移sar</li>

<li><p>压栈pushq 出栈popq</p></li>

<li><p>跳转
为了实现代码的复用和逻辑跳转,汇编引入一种控制命令:</p></li>

<li><p>返回ret</p></li>

<li><p>调用代码段 call</p></li>

<li><p>无条件跳转jmp 相同时跳转je/不相同时跳转jne 负数是跳转js/非负数时跳转jns</p></li>

<li><p>有符号大于jg/大于大于jge/小于jl/小于等于jle 跳转</p></li>

<li><p>无符号大于ja/大于大于jae/小于jb/小于等于jbe 跳转</p></li>
</ul>

<p>这里看到,除了无条件跳转,跳转控制需要先判断两个数是否相同,或前者是否大于后者,这里引入了一种控制码,标记操作数的一些状态,每次计算命令结束后,都会根据结果设置控制码.</p>

<p>控制码有:CF进位标志; ZF零标志; SF负数标志; OF溢出标志</p>

<p>举个例子,if (1 &gt; 2) testFunction(); 这一段C代码:</p>

<ul>
<li>计算机会先将1 2 这两个即使数放进寄存器mov 1 %rdi mov 2 %rsi</li>
<li>然后用1减去2,执行sub %rdi %rsi; 计算后,因为1-2 = -1, 所以计算后,设置ZF=0, SF=1, CF=0, OF=0</li>
<li>调用jg 0x000AF (假设这是testFunction的代码地址), jg命令发现ZF=0, SF=1, 判断前者减去后者肯定为负数,即前者小于后者,即不会进行跳转
<br /></li>
</ul>

<h2 id="4-处理器体系">4. 处理器体系</h2>

<h2 id="5-优化程序性能">5. 优化程序性能</h2>

<h2 id="toc_5">&hellip;</h2>

            </div>
            
            <div class="post-comments">
                
            </div>
            
            <div class="push"></div>
        </div>
        <footer class="footer text-center">
<p>Copyright &copy; 2020 Hello, I&#39;m trainyao. -
<span class="credit">
	Powered by
	<a target="_blank" href="https://gohugo.io">Hugo</a>
	and
	<a target="_blank" href="https://github.com/LordMathis/hugo-theme-nix/">Nix</a> theme.
</span>
</p>
</footer>

    </body>
